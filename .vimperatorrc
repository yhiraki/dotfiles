" vim: set ft=vim:

"===================="
" plugins
"===================="
" How to setup plugins
  " git clone https://github.com/vimpr/vimperator-plugins ~/.vimperator-plugins
  " ln -s ~/.vimperator-plugins/plugin_loader.js ~/.vimperator/

let g:plugin_loader_roots = '~/.vimperator-plugins'
let g:plugin_loader_plugins = '_libly,hint-tombloo,tinyurl,yetmappings,tab-history,feedSomeKeys_3,caret-hint,copy,walk-input,lookupDictionary,auto_detect_link,opener,forcefocuscontent,googlesuggest,edit-vimperator-files,google-search,imageextender,zoom-em-all,amazon_simple_uri,appendAnchor'

"===================="
" colorscheme
"===================="

" download colorscheme files first
" git clone https://github.com/vimpr/vimperator-colors.git ~/.vimperator/colors

" colorscheme simple
colorscheme indigo-fx3

"===================="
" general
"===================="

" ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ™ãƒ«ã‚’è¡¨ç¤ºã—ãªã„
set visualbell
highlight Bell display:none

" ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰æ™‚ã«è‡ªå‹•ã§IMEã‚’OFFã«ã™ã‚‹
" å‚è€ƒãƒšãƒ¼ã‚¸ http://vimperator.g.hatena.ne.jp/teramako/20090311/1236776437
style -name commandline-ime chrome://* #liberator-commandline-command input {ime-mode: inactive;}

" ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã¯ã‚¢ãƒ‰ã‚ªãƒ³ã¨ã‚¿ãƒ–ã®ã¿è¡¨ç¤º
set gui=addons,nobookmarks,nomenu,nonavigation,tabs

" ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã«SSLè¡¨ç¤ºã‚’è¿½åŠ 
set status=ssl,input,location,bookmark,history,tabcount,position

" R ã§.vimperatorrcã‚’å†èª­è¾¼ã¿
map R :source ~/.vimperatorrc<CR>

" full screen ã§ã‚‚ statusline ã‚’è¡¨ç¤º
set statuslinevisibility=visible

"===================="
" mappings
"===================="

"j/kã®ç§»å‹•é‡ã‚’5å€ã«å¤‰æ›´
nnoremap j 5j
nnoremap k 5k

" ãƒ’ãƒ³ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤‰æ›´
set hintchars=abcdefghijklmnopqrstuvwxyz234567890;,.[]-/
" set hintmatching=custom

" googleæ¤œç´¢ã‚’æ‰‹æ—©ãã™ã‚‹
noremap s :open<Space>google<Space>
noremap S :tabopen<Space>google<Space>

" undoä¸€è¦§ã‹ã‚‰é–‹ã
nnoremap U :undo<Space>

" hlsearchã‚’æ¶ˆã™
nnoremap <silent> <C-l> :<C-u>nohlsearch<CR>

" ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—é–¢é€£
" http://jagua.hatenablog.jp/entry/2012/12/08/001014
" :panorama ã®ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›å¾…ã¡
nnoremap <Leader>gc :<C-u>panorama<Space>
" ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç§»å‹•
nnoremap <Leader>gs :<C-u>panorama switch<Space>
" ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æ–°è¦ä½œæˆ
nnoremap <Leader>ga :<C-u>panorama add<Space>
" ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ãƒªã‚¹ãƒˆã‚’è¡¨ç¤º
nnoremap <Leader>gl :<C-u>panorama list<CR>
" ç¾åœ¨ã®ã‚¿ãƒ–ã‚’ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ 
nnoremap <Leader>gp :<C-u>panorama pushtab<Space>
" ç¾åœ¨ã®ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã«ã‚¿ãƒ–ã‚’è¿½åŠ 
nnoremap <Leader>gu :<C-u>panorama pulltab<Space>
" ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å‰Šé™¤
nnoremap <Leader>gr :<C-u>panorama remove<Space>
" ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ãƒ“ãƒ¥ãƒ¼ã‚’é–‹ã
nnoremap <Leader>go <C-S-e>

"Backspaceã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚
map <BS> ""

" @ã§ã‚¿ãƒ–ã®ãƒ”ãƒ³ç•™ã‚ã‚’ãƒˆã‚°ãƒ«
javascript <<EOM
liberator.modules.commands.addUserCommand(["togglepin"], "add pin to current tab",
function(){
  var currentTab = gBrowser.mCurrentTab
  if(currentTab.pinned){
    gBrowser.unpinTab(currentTab)
  }
  else{
   gBrowser.pinTab(currentTab)
  }
});
EOM
nnoremap @ :togglepin <CR>

"============================
" ignorekeys
"============================

ignorekeys clear

"============================
" copy.js
"============================

let g:caret_hint_swap_key = 'o'

"============================
" copy.js
"============================

javascript <<EOM
  liberator.globalVariables.copy_templates = [
    { label: 'title', value: '%TITLE%' },
    { label: 'plain', value: '%TITLE% %URL%' },
    { label: 'anchor', value: '<a href="%URL%">%TITLE%</a>' },
    { label: 'markdown', value: '[%TITLE%](%URL%)' },
    { label: 'confluencewiki', value: '[%TITLE%|%URL%]' },
  ];
EOM

"============================
" open in chrome
"============================

js <<EOM
liberator.modules.commands.addUserCommand(["OpenInChrome"], 'Open URL In Chrome',
  function(){
    if(liberator.has("MacUnix")){
      io.system('open -a "/Applications/Google\ Chrome.app" ' + "'"+ buffer.URL + "'");
    }
  },{}
);
EOM
nnoremap ,c :OpenInChrome <CR>

"============================
" feed some keys
"============================

command! -nargs=+ lazy autocmd VimperatorEnter .* <args>
lazy fmaps -u='mail\.google\.com/mail' c / j k n p o u e x s r <S-i>  a # [ ] ? gi gs gt gd ga gc
lazy fmaps -u='mail\.google\.com/mail/.*/[0-9a-f]+$' c / j,n k,p n,j p,k o u e x s r a # [ ] ? gi gs gt gd ga gc
lazy fmaps -u='feedly\.com' j k n p o v gh gm ga gg gl ? A / r m x s l f b
lazy fmaps -u='calendar\.google\.com' j r t + / s d w m x a c e <BS> z 

"============================
" hatena bookmark
"============================

" ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯æ‹¡å¼µã‚’ vimperator ã§æ“ä½œå¯èƒ½ã«ã™ã‚‹
javascript if (typeof hBookmark != 'undefined') liberator.loadScript('chrome://hatenabookmark/content/vimperator/plugin/hatenabookmark.js', {__proto__: this});

" ã‚­ãƒ¼ã®è¨­å®š
javascript <<EOF
liberator.globalVariables.hBookmark_shortcuts = {
  hintsAdd     : 'h',
  hintsComment : 'C',
  add          : ['h'],
  comment      : ['C'],
};
EOF

" smart completion ã«ã¯ã¦ãƒ–æ¤œç´¢ã‚’è¿½åŠ 
set complete+=H

" ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒãƒ¼ã‚’éè¡¨ç¤º
set gui+=nohatehaBookmarks

"èª­ã¿è¾¼ã¿å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
echo "vimperatorrc loaded."
